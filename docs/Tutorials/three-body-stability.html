

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Three-body Stability &#8212; Exoplanets within Binary Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mycss.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8VDVRMR2BH"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-8VDVRMR2BH');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Tutorials/three-body-stability';</script>
    <link rel="canonical" href="https://saturnaxis.github.io/exoplanet-binary/Tutorials/three-body-stability.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Planet Packing" href="planet-packing-stability.html" />
    <link rel="prev" title="2. N-body Simulations" href="nbody-integration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../home.html">
  
  
  
  
  
    <p class="title logo__title">Exoplanets within Binary Systems</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    Exoplanets within Binary Systems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Preamble/who-for.html">Who are these notes for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Preamble/cite-reuse.html">How to cite and reuse this material</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro-alpha-centauri.html">1. Introduction to the Î± Centauri System</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbody-integration.html">2. N-body Simulations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Three-body Stability</a></li>
<li class="toctree-l1"><a class="reference internal" href="planet-packing-stability.html">4. Planet Packing</a></li>
<li class="toctree-l1"><a class="reference internal" href="forced-eccentricity.html">5. Free and Forced Eccentricity</a></li>
<li class="toctree-l1"><a class="reference internal" href="obliquity-evolution.html">6. Obliquity Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-climlab.html">7. Basic Climate Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-genga.html">8. GPU-accelerated planet formation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/saturnaxis/exoplanet-binary/main?urlpath=tree/Tutorials/three-body-stability.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/saturnaxis/exoplanet-binary/blob/main/Tutorials/three-body-stability.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/saturnaxis/exoplanet-binary" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Tutorials/three-body-stability.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Three-body Stability</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#historical-overview">3.1. Historical overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-the-standard-stability-formulae">3.2. Updating the standard stability formulae</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-for-planets-in-binary-systems">3.3. Stability for planets in binary systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sample-simulation-kepler-16b">3.3.1. A sample simulation (Kepler-16b)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sample-simulation-gamma-cephei-ab">3.3.2. A sample simulation (<span class="math notranslate nohighlight">\(\gamma\)</span> Cephei Ab)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">3.4. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="three-body-stability">
<h1><span class="section-number">3. </span>Three-body Stability<a class="headerlink" href="#three-body-stability" title="Permalink to this heading">#</a></h1>
<section id="historical-overview">
<h2><span class="section-number">3.1. </span>Historical overview<a class="headerlink" href="#historical-overview" title="Permalink to this heading">#</a></h2>
<p>The three-body problem (<a class="reference external" href="https://en.wikipedia.org/wiki/Three-body_problem"><strong>TBP</strong></a>) was developed and studied by Isaac Newton is his pioneering work, <a class="reference external" href="https://en.wikipedia.org/wiki/Philosophi%C3%A6_Naturalis_Principia_Mathematica">the Principia</a>.  In Newtonâs formulation, a solution to the TBP would analytically (exactly) describe the motion of the Moon under the influence of gravity from both the Earth and the Sun.  However, this problem would not be solved by Newton (or anyone).</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Oscar_II">King Oscar II</a> commemorated his birthday in 1889 with a contest, where he invited the top scholars to attempt solutions to the TBP.  It was a French mathematician, <a class="reference external" href="https://en.wikipedia.org/wiki/Henri_Poincar%C3%A9">Henri Poincare</a>, at the University of Paris who âwonâ the contest.  Poincare showed that the TBP could not be solved due to an insufficient number of constants of motion (11) relative to the 18 equations of motion that generally define the problem.  In other words, the TBP is non-integrable does not have an unambiguous solution in terms of algebraic and transcendental functions.</p>
<p>Poincare showed that no solution to the general TBP exists, but some particular solutions do exist.  These solutions can have several requirements that are subsumed into the nomenclature.  For example, the <a class="reference external" href="https://farside.ph.utexas.edu/teaching/celestial/Celestial/node80.html">circular-restricted TBP</a> requires that the one body is much less massive than the other two (i.e., restricted <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(m_3 \ll m_1\)</span> and <span class="math notranslate nohighlight">\(m_3 \ll m_2\)</span>) and the two more massive bodies orbit one another on circular orbits.</p>
<p>Other solutions require central configurations, such as those proposed by Euler (<a class="reference external" href="https://en.wikipedia.org/wiki/Euler%27s_three-body_problem">collinear</a>) and Lagrange (<a class="reference external" href="https://en.wikipedia.org/wiki/Three-body_problem#Special-case_solutions">equilateral triangle</a>).  In 2013, physicists at the Institute of Physics in Belgrade discovered 13 new families in the equal-mass, zero angular momentum TBP (see their <a class="reference external" href="http://three-body.ipb.ac.rs/">gallery</a>).</p>
<p>Instead of searching for analytical solutions, others have used numerical approximations (or computational solutions) to solve the problem.  Although less elegant, such techniques are generally more practical because investigators can explore wide swathes of potential parameter space using modern parallel computing.</p>
<p>This guide will focus on numerical approaches for the case of a planet orbiting a pair of binary stars.  In this case, the planet is (at most) a Jupiter-mass body and naturally requires the restricted TBP because the two primary bodies are stellar masses (<span class="math notranslate nohighlight">\(m_2&gt;0.08\ M_\odot\)</span>; <span class="math notranslate nohighlight">\(m_1 \ge m_2\)</span>).  In 1982, Rudolf Dvorak defined three potential configurations of planets in binary systems: S-Type, P-Type, or T-Type (see Figure <a class="reference internal" href="#planet-configs"><span class="std std-numref">3.1</span></a>).</p>
<figure class="align-default" id="planet-configs">
<a class="reference internal image-reference" href="https://www.astronomy.com/wp-content/uploads/sites/2/2023/02/exoplanetorbits.png?resize=600%2C369"><img alt="planet configurations" src="https://www.astronomy.com/wp-content/uploads/sites/2/2023/02/exoplanetorbits.png?resize=600%2C369" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Possible configurations of exoplanets in binary star systems (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1982OAWMN.191..423D/abstract">Dvorak 1982</a>).  The planet can orbit either star (S-Type), both stars, (P-Type), or along the orbit of the secondary as a Trojan (T-Type). Figure credit: <a class="reference external" href="https://www.astronomy.com/science/can-solar-systems-exist-in-a-binary-star-system/">Astronomy: Roen Kelly</a>.</span><a class="headerlink" href="#planet-configs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="updating-the-standard-stability-formulae">
<h2><span class="section-number">3.2. </span>Updating the standard stability formulae<a class="headerlink" href="#updating-the-standard-stability-formulae" title="Permalink to this heading">#</a></h2>
<p>From <span class="math notranslate nohighlight">\({\sim}1980-2000\)</span>, the growth of computational power allowed researchers to better understand the motion of three bodies.  In the 1980s, most numerical simulations were limited to <span class="math notranslate nohighlight">\({\sim}10^3\ T_{\rm bin}\)</span> (scaled by the binary orbital period <span class="math notranslate nohighlight">\(T_{\rm bin}\)</span>) in simulation time due to the excessive wall time required for the computations.  Many researchers turned to dynamical indicators of chaos (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1980Mecc...15....9B/abstract">Benettin et al. (1980)</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1992AJ....104.1230L/abstract">Lecar et al. (1992)</a>,  <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1993CeMDA..56..409S/abstract">Smith &amp; Szebehely (1993)</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1997CeMDA..67...41F/abstract">Froeschle et al. (1997)</a>) to identify <em>possible routes</em> to unstable orbits.</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1986A%26A...167..379D/abstract">Dvorak (1986)</a> and <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1988A%26A...191..385R/abstract">Rabl &amp; Dvorak (1988)</a> showed that there is a transition between regular (periodic), quasi-periodic, and chaotic orbits for planets in binaries.  Unstable (or unbound) orbits are non-periodic, which can overlap in type with chaotic orbits.  There are chaotic orbits that remain bound to the system.  Therefore, chaos <strong>does not</strong> imply instability.</p>
<p>Orbital chaos is a sensitivity to initial conditions, which means that starting the planet or binary at slightly different positions can result in a drastically different orbital behavior.  Starting the planet a degree ahead (or behind) in its orbit through its initial mean (or true) anomaly means that the planet will feel a slightly different net force initially.  This slight difference in net force can speed up (or slow down) the planet and lead to an increase in its orbital eccentricity.  The secondary star can</p>
<ul class="simple">
<li><p>âpumpâ the planetâs orbital eccentricity through exchanges of angular momentum, or</p></li>
<li><p>scatter the planet (change in planetary semimajor axis) through exchanges of orbital energy.</p></li>
</ul>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert (1999)</a> focused on the potential to scatter a single planet.  They performed numerical simulations with the following assumptions:</p>
<ol class="arabic simple">
<li><p>The planet does not influence the orbit of the host binary (i.e., a test (zero-mass) particle).</p></li>
<li><p>The planet begins on a circular, coplanar orbit (relative to the host binary).</p></li>
<li><p>The planet and binary orbits can be scaled hierarchically, where the initial planetary <strong>semimajor axis ratio</strong> is <span class="math notranslate nohighlight">\(\rho = a_p/a_{\rm bin}\)</span>.</p></li>
<li><p>The binary masses are scaled by the <strong>mass ratio</strong> <span class="math notranslate nohighlight">\(\mu = m_2/(m_1+m_2)\)</span>, where <span class="math notranslate nohighlight">\(m_1\ge m_2\)</span>.</p></li>
<li><p>A critical semimajor axis <span class="math notranslate nohighlight">\(a_c\)</span> exists for the planet where planets with</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a_p \leq a_c\)</span> are bound for <span class="math notranslate nohighlight">\(10^4\)</span> binary orbits (i.e., scaled by <span class="math notranslate nohighlight">\(T_{\rm bin}\)</span>) and</p></li>
<li><p><span class="math notranslate nohighlight">\(a_p &gt; a_c\)</span> are unbound within a time <span class="math notranslate nohighlight">\(t&lt;10^4\ T_{\rm bin}\)</span>.</p></li>
</ul>
</li>
<li><p>The planetary and binary orbits are initially aligned <span class="math notranslate nohighlight">\((\omega_p = \omega_{\rm bin})\)</span>, where the binary begins at either periastron <span class="math notranslate nohighlight">\((f_{\rm bin} = 0^\circ)\)</span> or apastron <span class="math notranslate nohighlight">\((f_{\rm bin} = 180^\circ)\)</span>.</p></li>
</ol>
<p>These are not bad assumptions considering the computing power and knowledge of planetary systems during the late 1990s.  For a given mass ratio <span class="math notranslate nohighlight">\(\mu\)</span>, and binary eccentricity <span class="math notranslate nohighlight">\(e_{\rm bin}\)</span>, an initial condition <span class="math notranslate nohighlight">\((\rho,\ f_p)\)</span> is evaluated.  The semimajor axis ratio range differs for S-Type <span class="math notranslate nohighlight">\((0.02\leq \rho \leq 0.5)\)</span> and P-Type <span class="math notranslate nohighlight">\((1\leq \rho \leq 5)\)</span> (see Figure <a class="reference internal" href="#planet-configs"><span class="std std-numref">3.1</span></a>).  But eight equidistant values of the planetary true anomaly (<span class="math notranslate nohighlight">\(f_p = 0^\circ - 315^\circ;\ 45^\circ\)</span> increments) are used.  <em>Note that the planetary mean anomaly <span class="math notranslate nohighlight">\(M\)</span> and true anomaly <span class="math notranslate nohighlight">\(f\)</span> are interchangeable for <strong>circular</strong> orbits.</em></p>
<figure class="align-default" id="planet-ics">
<a class="reference internal image-reference" href="../_images/HW_Table1.png"><img alt="HW Table 1" src="../_images/HW_Table1.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Initial conditions used in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert (1999)</a> for both S-Type and P-Type planets.</span><a class="headerlink" href="#planet-ics" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This is a 4D space, where two dimensions <span class="math notranslate nohighlight">\((\mu\ \&amp;\ e_{\rm bin})\)</span> depend on the host binary, while the other two dimensions <span class="math notranslate nohighlight">\((\rho\ \&amp;\ f_p)\)</span> depend on the planetâs initial position.  It can be easier to conceptualize traversing this space through a 2D grid within another 2D grid as shown in Figure <a class="reference internal" href="#param-grid"><span class="std std-numref">3.3</span></a>.</p>
<figure class="align-default" id="param-grid">
<a class="reference internal image-reference" href="../_images/HW_4dim.png"><img alt="HW dimensions" src="../_images/HW_4dim.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.3 </span><span class="caption-text">A 4D parameter space abstracted into two nested 2D grids.</span><a class="headerlink" href="#param-grid" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The results of each nested grid can be summarized by identifying a critical semimajor axis ratio <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> for a given <span class="math notranslate nohighlight">\((\mu,\ e_{\rm bin})\)</span> combination.  The critical semimajor axis ratio <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> is defined as the boundary between stable and unstable initial conditions <span class="math notranslate nohighlight">\((\rho,\ f_p)\)</span>:</p>
<ul class="simple">
<li><p>one side of the boundary has a planet that survives the full simulation time for all values of <span class="math notranslate nohighlight">\(f_p\)</span></p></li>
<li><p>the other side has simulations that terminate early due to close approaches (i.e., scatters) with either star or an escape from the system.</p></li>
</ul>
<p>Table <a class="reference internal" href="#stability-grid1"><span class="std std-numref">3.4</span></a> shows the results for <span class="math notranslate nohighlight">\(\mu = e_{\rm bin} = 0.5\)</span> from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert (1999)</a> for S-Type planets, where the <span class="math notranslate nohighlight">\(&quot;+&quot;\)</span> symbols denote stable (i.e., no scatters or escapes).</p>
<figure class="align-default" id="stability-grid1">
<a class="reference internal image-reference" href="../_images/HW_Table2.png"><img alt="HW Table 2" src="../_images/HW_Table2.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Planet survival results for <span class="math notranslate nohighlight">\(\mu = e_{\rm bin} = 0.5\)</span> from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert (1999)</a> for S-Type planets.</span><a class="headerlink" href="#stability-grid1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Table <a class="reference internal" href="#stability-grid2"><span class="std std-numref">3.5</span></a> shows data that has been reduced, where each cell in the table represents the critical semimajor axis <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> determined through a smaller grid similar to Table <a class="reference internal" href="#stability-grid1"><span class="std std-numref">3.4</span></a>.</p>
<figure class="align-default" id="stability-grid2">
<a class="reference internal image-reference" href="../_images/HW_Table3.png"><img alt="HW Table 3" src="../_images/HW_Table3.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Planetary critical semimajor axis <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert (1999)</a> for S-Type planets.</span><a class="headerlink" href="#stability-grid2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>From Table <a class="reference internal" href="#stability-grid2"><span class="std std-numref">3.5</span></a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert 1999</a> perform a least-squares fit given the trial function:</p>
<div class="math notranslate nohighlight" id="equation-hw-formula">
<span class="eqno">(3.1)<a class="headerlink" href="#equation-hw-formula" title="Permalink to this equation">#</a></span>\[\rho_{\rm cr} = c_1 + c_2\mu + c_3e_{\rm bin} + c_4\mu e_{\rm bin} + c_5 e_{\rm bin}^2 + c_6 \mu e_{\rm bin}^2.\]</div>
<p>The least-squares fitting procedure identifies values of <span class="math notranslate nohighlight">\(c_1-c_6\)</span> that minimizes <span class="math notranslate nohighlight">\(\chi^2\)</span> (e.g., the residuals or cost function).</p>
<p>The above procedure has merits in that it will accurately reproduce the critical semimajor axis <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> for other parts of the <span class="math notranslate nohighlight">\((\mu,\ e_{\rm bin})\)</span> parameter space through an easy-to-use polynomial.  However, larger discrepancies appear when extrapolating to broad regimes of mass ration <span class="math notranslate nohighlight">\(\mu\)</span> (e.g., <span class="math notranslate nohighlight">\(\mu \leq 0.1\)</span> and <span class="math notranslate nohighlight">\(\mu \geq 0.9\)</span>).  There can be significant differences if the planetary orbit is misaligned with the host binary, which is expected from disk observations in binaries (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2006A%26A...446..201M/abstract">Monin et al. (2006)</a>).</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2020AJ....159...80Q/abstract">Quarles et al. (2020)</a> addresses these issues in two ways:</p>
<ol class="arabic simple">
<li><p>expand the simulations to cover a wider range in <span class="math notranslate nohighlight">\(\mu\)</span> and increase the grid resolution,</p></li>
<li><p>evaluate the simulations for a range of planet inclinations.</p></li>
</ol>
<p>Figure <a class="reference internal" href="#stability-grid3"><span class="std std-numref">3.6</span></a> illustrates the results of <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2020AJ....159...80Q/abstract">Quarles et al. (2020)</a>, where the color-code represents <span class="math notranslate nohighlight">\(\rho_{cr}\)</span> and each panel assumes a different initial inclination for the planet.</p>
<figure class="align-default" id="stability-grid3">
<a class="reference internal image-reference" href="../_images/Q20_Fig7.png"><img alt="Q20 Fig 7" src="../_images/Q20_Fig7.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Planetary critical semimajor axis <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> (color-coded) from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2020AJ....159...80Q/abstract">Quarles et al. (2020)</a> for S-Type planets.  Each panel illustrates how the value of <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span> changes with planetary inclination.</span><a class="headerlink" href="#stability-grid3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The above parameter spaces can also be fit using the same trial function (Eq. <a class="reference internal" href="#equation-hw-formula">(3.1)</a>), but the data underlying the above figure is available in a GitHub repo <a class="reference external" href="https://github.com/saturnaxis/ThreeBody_Stability">saturnaxis:ThreeBody_Stability</a>.  Using the data file for the coplanar case and `interp2D``, one can easily identify <span class="math notranslate nohighlight">\(\rho_{\rm cr}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp2d</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ebin</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">github_file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/saturnaxis/ThreeBody_Stability/master/a_crit_Incl[0].txt&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">github_file</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">comments</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">0.001</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),[</span><span class="mf">0.999</span><span class="p">]))</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.81</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">zi</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="n">Z</span><span class="p">,(</span><span class="n">xi</span><span class="p">[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">yi</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]),</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">interp2d</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">astab</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">ebin</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For mu = </span><span class="si">%1.2f</span><span class="s2">, e_bin = </span><span class="si">%1.2f</span><span class="s2">, the critical semimajor axis ratio rho_cr = </span><span class="si">%1.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ebin</span><span class="p">,</span><span class="n">astab</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For mu = 0.50, e_bin = 0.50, the critical semimajor axis ratio rho_cr = 0.12
</pre></div>
</div>
</div>
</div>
<p>A nearly identical procedure can be applied to determine the critical semimajor axis ratio for P-Type planets using the GitHub repo <a class="reference external" href="https://github.com/saturnaxis/CBP_stability">saturnaxis:CBP_stability</a> from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJ...856..150Q/abstract">Quarles et al. (2018)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp2d</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.2937</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.2937</span><span class="p">)</span>  <span class="c1">#converting from q --&gt; mu  Doyle et al. (2011)</span>
<span class="n">ebin</span> <span class="o">=</span> <span class="mf">0.15944</span>

<span class="n">github_file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/saturnaxis/CBP_stability/master/a_crit.txt&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">github_file</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">comments</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">0.001</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),[</span><span class="mf">0.999</span><span class="p">]))</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.81</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">zi</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="n">Z</span><span class="p">,(</span><span class="n">xi</span><span class="p">[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">yi</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]),</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">interp2d</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">astab</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">ebin</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For mu = </span><span class="si">%1.2f</span><span class="s2">, e_bin = </span><span class="si">%1.2f</span><span class="s2">, the critical semimajor axis ratio rho_cr = </span><span class="si">%1.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ebin</span><span class="p">,</span><span class="n">astab</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For mu = 0.23, e_bin = 0.16, the critical semimajor axis ratio rho_cr = 2.70
</pre></div>
</div>
</div>
</div>
</section>
<section id="stability-for-planets-in-binary-systems">
<h2><span class="section-number">3.3. </span>Stability for planets in binary systems<a class="headerlink" href="#stability-for-planets-in-binary-systems" title="Permalink to this heading">#</a></h2>
<p>Determining the stability for a P-Type or S-Type planet requires asking a few questions:</p>
<ol class="arabic simple">
<li><p>Does the planet remain in orbit around the central binary?</p>
<ul class="simple">
<li><p>If so, for how long?</p></li>
</ul>
</li>
<li><p>Do the planetary orbital elements vary in time?</p>
<ul class="simple">
<li><p>Are the variations in orbital elements bounded?</p></li>
<li><p>Does the planetary eccentricity grow secularly?</p></li>
</ul>
</li>
<li><p>Does the central binary force the planetary orbit?</p></li>
</ol>
<p>Below are a few numerical experiments for a known circumbinary planet, Kepler-16b (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011Sci...333.1602D/abstract">Doyle et al. (2011)</a>).</p>
<section id="a-sample-simulation-kepler-16b">
<h3><span class="section-number">3.3.1. </span>A sample simulation (Kepler-16b)<a class="headerlink" href="#a-sample-simulation-kepler-16b" title="Permalink to this heading">#</a></h3>
<p>To start exploring the dynamics of Kepler-16b (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011Sci...333.1602D/abstract">Doyle et al. (2011)</a>), we create a simulation in <strong>rebound</strong> using the parameters from the discovery paper.  To customize the simulation, we define</p>
<ul class="simple">
<li><p>tscale: the number of years that we want to run the simulation.</p></li>
<li><p>output_bin: the name (as a string) of the output binary file that stores the simulation archive.</p></li>
<li><p>output_steps: the number of steps (as an integer) that simulation archive will wait until saving a system state.</p></li>
</ul>
<p>The code below demonstrates a short simulation of only 10 years to show the orbit of the planet and central binary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">M_J</span> <span class="o">=</span> <span class="mf">9.54e-4</span> <span class="c1">#Jupiter mass in Msun</span>

<span class="c1">#Kepler-16 parameters from Doyle et al. (2011)</span>
<span class="n">M_A</span> <span class="o">=</span> <span class="mf">0.6897</span> <span class="c1">#mass of star A in Msun</span>
<span class="n">M_B</span> <span class="o">=</span> <span class="mf">0.20255</span> <span class="c1">#mass of star B in Msun</span>
<span class="n">a_bin</span> <span class="o">=</span> <span class="mf">0.22431</span> <span class="c1">#binary semimajor axis in AU</span>
<span class="n">T_bin</span> <span class="o">=</span> <span class="mf">41.079220</span><span class="o">/</span><span class="mf">365.25</span> <span class="c1">#binary orbital period in yr</span>
<span class="n">e_bin</span> <span class="o">=</span> <span class="mf">0.15944</span> <span class="c1">#binary eccentricity</span>
<span class="n">inc_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">90.30401</span><span class="p">)</span> <span class="c1">#binary inclination on the sky plane</span>
<span class="n">omg_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">263.464</span><span class="p">)</span> <span class="c1">#binary argument of periapse</span>
<span class="n">RA_bin</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#binary longitude of nodes</span>
<span class="n">MA_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">92.352</span><span class="p">)</span> <span class="o">-</span> <span class="n">omg_bin</span> <span class="c1">#binary mean anomaly from mean longitude</span>

<span class="n">M_p</span> <span class="o">=</span> <span class="mf">0.333</span><span class="o">*</span><span class="n">M_J</span>
<span class="n">a_p</span> <span class="o">=</span> <span class="mf">0.7048</span> <span class="c1">#planet semimajor axis in AU</span>
<span class="n">T_p</span> <span class="o">=</span> <span class="mf">228.776</span><span class="o">/</span><span class="mf">365.25</span> <span class="c1">#planetary orbital period in yr</span>
<span class="n">e_p</span> <span class="o">=</span> <span class="mf">0.0069</span> 
<span class="n">inc_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">90.0322</span><span class="p">)</span> <span class="c1">#planetary inclination on the sky plane</span>
<span class="n">omg_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">318</span><span class="p">)</span> <span class="c1">#planetary argument of periapse</span>
<span class="n">RA_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">0.003</span><span class="p">)</span> <span class="c1"># planetary longitude of nodes</span>
<span class="n">MA_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">106.51</span><span class="p">)</span> <span class="o">-</span> <span class="n">omg_p</span> <span class="c1">#planetary mean anomaly from mean longitude</span>

<span class="k">def</span> <span class="nf">simulation</span><span class="p">(</span><span class="n">tscale</span><span class="p">,</span><span class="n">fname</span><span class="p">,</span><span class="n">out_step</span><span class="p">):</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">Simulation</span><span class="p">()</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">integrator</span> <span class="o">=</span> <span class="s1">&#39;ias15&#39;</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;AU&#39;</span><span class="p">,</span><span class="s1">&#39;yr&#39;</span><span class="p">,</span><span class="s1">&#39;Msun&#39;</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.025</span><span class="o">*</span><span class="n">T_bin</span>

    <span class="n">sim</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">M_A</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">M_B</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a_bin</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">e_bin</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">inc_bin</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="n">omg_bin</span><span class="p">,</span><span class="n">Omega</span><span class="o">=</span><span class="n">RA_bin</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">MA_bin</span><span class="p">)</span> 
    <span class="n">sim</span><span class="o">.</span><span class="n">move_to_com</span><span class="p">()</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">M_p</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a_p</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">e_p</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">inc_p</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="n">omg_p</span><span class="p">,</span><span class="n">Omega</span><span class="o">=</span><span class="n">RA_p</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">MA_p</span><span class="p">)</span>

    <span class="n">sim</span><span class="o">.</span><span class="n">automateSimulationArchive</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="n">out_step</span><span class="p">,</span><span class="n">deletefile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">tscale</span><span class="p">)</span>

<span class="n">output_bin</span> <span class="o">=</span> <span class="s2">&quot;Kepler16.bin&quot;</span>
<span class="n">output_steps</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">simulation</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">output_bin</span><span class="p">,</span><span class="n">output_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that a simulation has been run, we want to visualize the orbit.  However, the input coordinates were given using the sky plane.  Therefore, we will need to rotate the position vector to give us a face-on view of the system. Alternatively, we could have used the <span class="math notranslate nohighlight">\(x-z\)</span> plane to get the same view.</p>
<p>The code below extracts the Cartesian coordinates from the simulation archive and creates a visualization using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 

<span class="k">def</span> <span class="nf">Rot</span><span class="p">(</span><span class="n">ang1</span><span class="p">,</span><span class="n">ang2</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="n">rot_omg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="mi">0</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">rot_inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang2</span><span class="p">),</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang2</span><span class="p">)],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang2</span><span class="p">)]])</span>
    <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_omg</span><span class="p">,</span><span class="n">rot_inc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_mat</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#plot the simulation</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">SimulationArchive</span><span class="p">(</span><span class="n">output_bin</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">xy_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">)):</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="c1">#iterate through each snapshot in sa</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">particles</span> <span class="c1">#intermediate object to simplify the referencing</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">move_to_com</span><span class="p">()</span> <span class="c1">#shift to center-of-mass coordinates</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ps</span><span class="p">)):</span>
        <span class="n">Cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ps</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ps</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ps</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
        <span class="n">rot_xy</span> <span class="o">=</span> <span class="n">Rot</span><span class="p">(</span><span class="o">-</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Omega</span><span class="p">,</span><span class="o">-</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">,</span><span class="n">Cart</span><span class="p">)</span>
        <span class="n">xy_coords</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">xy_coords</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>   
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[:,</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[:,</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (AU)&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (AU)&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a447a835d2b77dcd60c4e73ecfba100a3abb78eb241a4a667561898c2b2c8a79.png" src="../_images/a447a835d2b77dcd60c4e73ecfba100a3abb78eb241a4a667561898c2b2c8a79.png" />
</div>
</div>
<p>In the above figure, barycentric coordinates are used so that we can see the changing position of star A (red) and star B (cyan) relative to the center-of-mass (<span class="math notranslate nohighlight">\(\times\)</span> symbol) at the origin.  Those orbits are Keplerian because the planetary mass is insufficient to strongly perturb the inner binary (at least on this scale).</p>
<p>The planetary orbit is <em>not Keplerian</em> because it experiences a varying perturbation from the inner binary.  As a result, the planetâs position jitters about some average orbit.  Moreover, there is some change in the planetâs semimajor axis, which causes its orbital period to change slightly from one orbit to the next.</p>
<p>To understand the long-term dynamics, a simulation of at least 100 years is needed.  The nodal precession timescale for the planet is <span class="math notranslate nohighlight">\({\sim}50\)</span> years, where 100 years represents two full oscillations of the apsidal precession.  Since we are not as interested in the short-term dynamics, we can increase the number of output steps so that the simulation remains fast (in wall time).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_bin</span> <span class="o">=</span> <span class="s2">&quot;Kepler16_long.bin&quot;</span>
<span class="n">output_steps</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">simulation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">output_bin</span><span class="p">,</span><span class="n">output_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Again, the dynamics is best understood through a series of figures that show how the orbit is changing with time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 

<span class="c1">#plot the simulation</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">SimulationArchive</span><span class="p">(</span><span class="n">output_bin</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax11</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="n">ax12</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">232</span><span class="p">)</span>
<span class="n">ax13</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">233</span><span class="p">)</span>
<span class="n">ax21</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">234</span><span class="p">)</span>
<span class="n">ax22</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
<span class="n">ax23</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">236</span><span class="p">)</span>

<span class="n">pl_orb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">))</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">)):</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="c1">#iterate through each snapshot in sa</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">particles</span> <span class="c1">#intermediate object to simplify the referencing</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">move_to_com</span><span class="p">()</span> <span class="c1">#shift to center-of-mass coordinates</span>
    <span class="n">time</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">t</span>
    <span class="n">del_Omega</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">Omega</span> <span class="o">-</span> <span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Omega</span>
    <span class="n">omg_p</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">omega</span>
    <span class="n">mut_incl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">del_Omega</span><span class="p">))</span>
    <span class="n">pl_orb</span><span class="p">[</span><span class="n">s</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">e</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">mut_incl</span><span class="p">),</span><span class="n">omg_p</span><span class="p">,</span><span class="n">del_Omega</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">]</span>

<span class="c1">#calculate the vector components of eccentricity and inclination</span>
<span class="n">ecosw</span><span class="p">,</span> <span class="n">esinw</span> <span class="o">=</span> <span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">icosO</span><span class="p">,</span> <span class="n">isinO</span> <span class="o">=</span> <span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">4</span><span class="p">])</span>

<span class="n">e_F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ecosw</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">esinw</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">w_F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">esinw</span><span class="p">,</span><span class="n">ecosw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;forced eccentricity e_F = </span><span class="si">%1.3f</span><span class="s2">; forced periapse w_F = </span><span class="si">%1.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e_F</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">w_F</span><span class="p">)</span><span class="o">+</span><span class="mi">360</span><span class="p">))</span>

<span class="n">ax11</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$e_p$&quot;</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]),</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\omega_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecosw</span><span class="p">,</span><span class="n">esinw</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$e_p\ \sin\ \omega_p$&quot;</span><span class="p">)</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">ax11</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="o">+</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$e_p\ \cos\ \omega_p$&quot;</span><span class="p">)</span>

<span class="n">ax21</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$i_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">ax22</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]),</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax22</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Omega_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">ax23</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]),</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]),</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax23</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$i_p\ \sin\ \Omega_p$&quot;</span><span class="p">)</span>

<span class="n">ax21</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax22</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax23</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$i_p\ \cos\ \Omega_p$&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>forced eccentricity e_F = 0.034; forced periapse w_F = 278.553
</pre></div>
</div>
<img alt="../_images/0eef7469d2e6b95b1cb524deae0dfcc4a5d60325a67613d518d08110138c739f.png" src="../_images/0eef7469d2e6b95b1cb524deae0dfcc4a5d60325a67613d518d08110138c739f.png" />
</div>
</div>
<p>The above figures show the evolution of the planetâs eccentricity and inclination vectors.  The planetary eccentricity vector illustrates how the shape of the orbit changes over time <strong>and</strong> how the orbit can rotate relative to the binary orbital plane.  The inclination vector represents how the planetary orbit can tilt and wobble with time (i.e., like a plate on a table).  Each of these vectors can have two components: <strong>free</strong> and <strong>forced</strong>.  The forced component shifts the mean value of the vectors away from the origin.</p>
<p>The top-left panel shows the planetary eccentricity  <span class="math notranslate nohighlight">\(e_p\)</span> changing over 100 years, while the top-middle panel shows the evolution of the planetary argument of periapse <span class="math notranslate nohighlight">\(\omega_p\)</span>.  The forced component increases the mean eccentricity to <span class="math notranslate nohighlight">\(0.034\)</span>, while the argument of periapse is <span class="math notranslate nohighlight">\({\sim}278^\circ\)</span>.  The top-right panel shows how the direction of the eccentricity vector changes over the simulation.  The red dot marks the origin, where in the absence of a forced component it would lie in the center.  Instead, all the points appear to orbit a fixed point with a radius equal to the forced eccentricity <span class="math notranslate nohighlight">\(e_F\)</span> and rotated by an angle equal to the forced argument of periapse <span class="math notranslate nohighlight">\(\omega_F\)</span>, in polar coordinates.</p>
<p>The bottom row represents similar panels, but using the planetary inclination <span class="math notranslate nohighlight">\(i_p\)</span> and longitude of ascending node <span class="math notranslate nohighlight">\(\Omega_p\)</span>. The planetary orbit appears to couple tightly with the binary orbit.  Naively, this would suggest that the system will continue to transit indefinitely.  However, we must consider that the inclination shown here is the <strong>mutual inclination</strong> and if the binary orbital plane tilts relative to our line-of-sight, then the planetary orbit will also tilt along with it.  As a result, our ability to view Kepler-16b transiting its host star is temporary and will only occur when the alignment is just right (e.g., the transit of Venus or Mercury across our Sun).  More broadly, the circumbinary planet community has dubbed this ability to transit as <em>transitability</em> (see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2015MNRAS.449..781M/abstract">Martin &amp; Triaud (2015)</a> and <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2017MNRAS.465.3235M/abstract">Martin (2017)</a> for more details).</p>
</section>
<section id="a-sample-simulation-gamma-cephei-ab">
<h3><span class="section-number">3.3.2. </span>A sample simulation (<span class="math notranslate nohighlight">\(\gamma\)</span> Cephei Ab)<a class="headerlink" href="#a-sample-simulation-gamma-cephei-ab" title="Permalink to this heading">#</a></h3>
<p>A similar analysis can be performed for an S-Type planet, which orbits only one of the two stars in the binary system.  Such planets typically orbit <span class="math notranslate nohighlight">\({\sim}1-2\ {\rm AU}\)</span> from their host star, while the binary separation is <span class="math notranslate nohighlight">\({\gtrsim}20\ {\rm AU}\)</span>.  One of the first S-Type planets discovered is in <span class="math notranslate nohighlight">\(\gamma\)</span> Cephei AB (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1988ApJ...331..902C/abstract">Campbell et al. (1988)</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2003ApJ...599.1383H/abstract">Hatzes et al. (2003)</a>).  This example uses parameters from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2022AJ....164..177H/abstract">Huang &amp; Ji (2022)</a>, who refit the system using astrometric data from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011A%26A...527A.140R/abstract">Reffert &amp; Quirrenbach (2011)</a>.</p>
<p>To start exploring the dynamics of <span class="math notranslate nohighlight">\(\gamma\)</span> Cep Ab (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2022AJ....164..177H/abstract">Huang &amp; Ji (2022)</a>), we create a simulation in <strong>rebound</strong> using the parameters from this paper.  To customize the simulation, we define</p>
<ul class="simple">
<li><p>tscale: the number of years that we want to run the simulation.</p></li>
<li><p>output_bin: the name (as a string) of the output binary file that stores the simulation archive.</p></li>
<li><p>output_steps: the number of steps (as an integer) that simulation archive will wait until saving a system state.</p></li>
</ul>
<p>The code below demonstrates a short simulation of only 100 years to show the orbit of the planet and binary.  The integration step <code class="docutils literal notranslate"><span class="pre">sim.dt</span></code> is now a fraction of the planetary orbit because its orbital period is much shorter than the binary orbital period.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">M_J</span> <span class="o">=</span> <span class="mf">9.54e-4</span> <span class="c1">#Jupiter mass in Msun</span>

<span class="c1">#Parameters from Huang &amp; Ji (2022)</span>
<span class="n">M_A</span> <span class="o">=</span> <span class="mf">1.40</span> <span class="c1">#mass of star A in Msun</span>
<span class="n">M_B</span> <span class="o">=</span> <span class="mf">0.39</span> <span class="c1">#mass of star B in Msun</span>
<span class="n">a_bin</span> <span class="o">=</span> <span class="mf">18.64</span> <span class="c1">#binary semimajor axis in AU</span>
<span class="n">T_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_bin</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">M_A</span><span class="o">+</span><span class="n">M_B</span><span class="p">))</span> <span class="c1">#binary orbital period in yr</span>
<span class="n">e_bin</span> <span class="o">=</span> <span class="mf">0.36</span> <span class="c1">#binary eccentricity</span>
<span class="n">inc_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">119.3</span><span class="p">)</span> <span class="c1">#binary inclination on the sky plane</span>
<span class="n">omg_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">158.9</span><span class="p">)</span> <span class="c1">#binary argument of periapse</span>
<span class="n">RA_bin</span> <span class="o">=</span> <span class="mf">18.04</span> <span class="c1">#binary longitude of nodes</span>
<span class="n">MA_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">296.12</span><span class="p">)</span> <span class="c1">#binary mean anomaly from posterior plot</span>


<span class="n">a_p</span> <span class="o">=</span> <span class="mf">2.14</span> <span class="c1">#planet semimajor axis in AU</span>
<span class="n">T_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_p</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">M_A</span><span class="p">)</span> <span class="c1">#planetary orbital period in yr</span>
<span class="n">e_p</span> <span class="o">=</span> <span class="mf">0.085</span> 
<span class="n">inc_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">173</span><span class="p">)</span> <span class="c1">#planetary inclination on the sky plane</span>
<span class="n">omg_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span> <span class="c1">#planetary argument of periapse</span>
<span class="n">RA_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">356</span><span class="p">)</span> <span class="c1"># planetary longitude of nodes</span>
<span class="n">MA_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">264</span><span class="p">)</span> <span class="c1">#planetary mean anomaly from posterior plot</span>
<span class="n">M_p</span> <span class="o">=</span> <span class="mf">1.63</span><span class="o">*</span><span class="n">M_J</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">inc_p</span><span class="p">)</span> <span class="c1">#Planet mass in Msun from msini</span>

<span class="k">def</span> <span class="nf">simulation</span><span class="p">(</span><span class="n">tscale</span><span class="p">,</span><span class="n">fname</span><span class="p">,</span><span class="n">out_step</span><span class="p">):</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">Simulation</span><span class="p">()</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">integrator</span> <span class="o">=</span> <span class="s1">&#39;whfast&#39;</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;AU&#39;</span><span class="p">,</span><span class="s1">&#39;yr&#39;</span><span class="p">,</span><span class="s1">&#39;Msun&#39;</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.0125</span><span class="o">*</span><span class="n">T_p</span>

    <span class="n">sim</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">M_A</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">M_p</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a_p</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">e_p</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">inc_p</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="n">omg_p</span><span class="p">,</span><span class="n">Omega</span><span class="o">=</span><span class="n">RA_p</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">MA_p</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">M_B</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a_bin</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">e_bin</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">inc_bin</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="n">omg_bin</span><span class="p">,</span><span class="n">Omega</span><span class="o">=</span><span class="n">RA_bin</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">MA_bin</span><span class="p">)</span> 
    <span class="n">sim</span><span class="o">.</span><span class="n">move_to_com</span><span class="p">()</span>

    <span class="n">sim</span><span class="o">.</span><span class="n">automateSimulationArchive</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="n">out_step</span><span class="p">,</span><span class="n">deletefile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">tscale</span><span class="p">)</span>

<span class="n">output_bin</span> <span class="o">=</span> <span class="s2">&quot;gammaCep.bin&quot;</span>
<span class="n">output_steps</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">simulation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">output_bin</span><span class="p">,</span><span class="n">output_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that a simulation has been run, we want to visualize the orbit.  However, the input coordinates were given using the sky plane.  Therefore, we will need to rotate the position vector (using the <em>inclination of the binary</em>) to give us a face-on view of the system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The planetary orbit is <strong>not</strong> coplanar with the outer binary orbit and the binary orbit is not coplanar with the sky plane.  As a result, some parts of each orbit will be above or below the reference plane.</p>
</div>
<p>The code below extracts the Cartesian coordinates from the simulation archive and creates a visualization using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>

<span class="k">def</span> <span class="nf">Rot</span><span class="p">(</span><span class="n">ang1</span><span class="p">,</span><span class="n">ang2</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="n">rot_omg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="mi">0</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang1</span><span class="p">),</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">rot_inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang2</span><span class="p">),</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang2</span><span class="p">)],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ang2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ang2</span><span class="p">)]])</span>
    <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_omg</span><span class="p">,</span><span class="n">rot_inc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_mat</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#plot the simulation</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">SimulationArchive</span><span class="p">(</span><span class="n">output_bin</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.5</span><span class="p">),</span> <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">axins</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">xy_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">),</span><span class="mi">9</span><span class="p">))</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">)):</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="c1">#iterate through each snapshot in sa</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">particles</span> <span class="c1">#intermediate object to simplify the referencing</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">move_to_hel</span><span class="p">()</span> <span class="c1">#shift to astrocentric coordinates</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ps</span><span class="p">)):</span>
        <span class="n">Cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ps</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ps</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ps</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
        <span class="n">rot_xy</span> <span class="o">=</span> <span class="n">Rot</span><span class="p">(</span><span class="o">-</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">Omega</span><span class="p">,</span><span class="o">-</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">,</span><span class="n">Cart</span><span class="p">)</span>
        
        <span class="n">xy_coords</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">xy_coords</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xy_coords</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_xy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span> 
    <span class="n">pos_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  
    <span class="n">neg_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">neg_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">neg_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">pos_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">pos_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">neg_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">neg_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">axins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">pos_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="n">pos_z</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">],</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axins</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.25</span><span class="p">)</span>
<span class="n">axins</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.25</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (AU)&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (AU)&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0d0dc2a34bb085b77f0ba36ef98be3d4255a99c3f165e16312c7e618171e1ea4.png" src="../_images/0d0dc2a34bb085b77f0ba36ef98be3d4255a99c3f165e16312c7e618171e1ea4.png" />
</div>
</div>
<p>In the above figure, astrocentric coordinates are used so that we can see the changing position of the planet (cyan) and star B (cyan) relative to the primary star A (red).</p>
<p>To understand the long-term dynamics for <span class="math notranslate nohighlight">\(\gamma\)</span> Cep Ab, a simulation of at least 50,000 years is needed because the nodal precession timescale for the planet is much longer.  Since we are not as interested in the short-term dynamics, we can increase the number of output steps so that the simulation remains fast (in wall time).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_bin</span> <span class="o">=</span> <span class="s2">&quot;gammaCep_long.bin&quot;</span>
<span class="n">output_steps</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">simulation</span><span class="p">(</span><span class="mf">5e4</span><span class="p">,</span><span class="n">output_bin</span><span class="p">,</span><span class="n">output_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">cm</span>

<span class="n">output_bin</span> <span class="o">=</span> <span class="s2">&quot;gammaCep_long.bin&quot;</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="mf">5e4</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;jet&#39;</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">t_max</span><span class="p">)</span>

<span class="c1">#plot the simulation</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">SimulationArchive</span><span class="p">(</span><span class="n">output_bin</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax11</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="n">ax12</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">232</span><span class="p">)</span>
<span class="n">ax13</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">233</span><span class="p">)</span>
<span class="n">ax21</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">234</span><span class="p">)</span>
<span class="n">ax22</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
<span class="n">ax23</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">236</span><span class="p">)</span>

<span class="n">pl_orb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">))</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">)):</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="c1">#iterate through each snapshot in sa</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">particles</span> <span class="c1">#intermediate object to simplify the referencing</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">move_to_hel</span><span class="p">()</span> <span class="c1">#shift to astrocentric coordinates</span>
    <span class="n">time</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">t</span>
    <span class="n">del_Omega</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">Omega</span> <span class="o">-</span> <span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Omega</span>
    <span class="n">omg_p</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">omega</span>
    <span class="k">if</span> <span class="n">omg_p</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span> <span class="n">omg_p</span> <span class="o">-=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">mut_incl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">del_Omega</span><span class="p">))</span>
    <span class="n">pl_orb</span><span class="p">[</span><span class="n">s</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">mut_incl</span><span class="p">),</span><span class="n">omg_p</span><span class="p">,</span><span class="n">del_Omega</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">]</span>

<span class="n">ax11</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">my_cmap</span><span class="p">)</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$e_p$&quot;</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]),</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">my_cmap</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\omega_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span><span class="mi">3</span><span class="p">]),</span><span class="mf">1.</span><span class="o">-</span><span class="n">pl_orb</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">my_cmap</span><span class="p">)</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$1-e_p^2$&quot;</span><span class="p">)</span>

<span class="n">ax11</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="o">+</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$\omega_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">ax13</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span>

<span class="n">ax21</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">my_cmap</span><span class="p">)</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$i_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">ax22</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]),</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">my_cmap</span><span class="p">)</span>
<span class="n">ax22</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Omega_p$ (deg.)&quot;</span><span class="p">)</span>
<span class="n">ax23</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span><span class="mi">4</span><span class="p">]),</span><span class="n">pl_orb</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pl_orb</span><span class="p">[</span><span class="n">start</span><span class="p">:,</span><span class="mi">4</span><span class="p">]),</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">my_cmap</span><span class="p">)</span>
<span class="n">ax23</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$i_p\ \sin\ \Omega_p$&quot;</span><span class="p">)</span>

<span class="n">ax21</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax22</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (yr)&quot;</span><span class="p">)</span>
<span class="n">ax23</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$i_p\ \cos\ \Omega_p$&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ddd6e99247032bedb1d78d79bd02cbcf7e4fbba7634093a00463edebb8ca074.png" src="../_images/6ddd6e99247032bedb1d78d79bd02cbcf7e4fbba7634093a00463edebb8ca074.png" />
</div>
</div>
<p>These panels are color-coded with time (<span class="math notranslate nohighlight">\(t=0 \rightarrow\)</span> dark blue and <span class="math notranslate nohighlight">\(t=5\times 10^4\ {\rm yr} \rightarrow\)</span> dark red).  The eccentricity and inclination are anti-correlated due to the <a class="reference external" href="https://en.wikipedia.org/wiki/Kozai_mechanism">Lidov-Kozai mechanism</a>.  The argument of pericenter <span class="math notranslate nohighlight">\(\omega_p\)</span> and longitude of ascending node <span class="math notranslate nohighlight">\(\Omega_p\)</span> are librating (i.e., oscillating between values but not a full rotation).  For the Lidov-Kozai mechanism, we expect orbits around a fixed point using <span class="math notranslate nohighlight">\(\omega_p\)</span> and <span class="math notranslate nohighlight">\(1-e_p^2\)</span> as coordinates, specifically at <span class="math notranslate nohighlight">\(\omega_p = 90^\circ\)</span> or <span class="math notranslate nohighlight">\(\omega_p = 270^\circ\)</span> (see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2016ARA%26A..54..441N/abstract">Naoz (2016)</a> for more details).</p>
<p>The long-term growth of eccentricity and inclination does not bode well for stability.  Due to the relatively high eccentricity of star B, the outer (stellar) orbit can exchange angular momentum with inner (planetary) orbit.  It appears that after <span class="math notranslate nohighlight">\(5\times 10^4\)</span> years, the planetâs orbit can flip so that it begins orbiting in retrograde relative to the binary orbit.</p>
</section>
</section>
<section id="references">
<h2><span class="section-number">3.4. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1980Mecc...15....9B/abstract">Benettin et al. (1980)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1988ApJ...331..902C/abstract">Campbell et al. (1988)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011Sci...333.1602D/abstract">Doyle et al. (2011)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1986A%26A...167..379D/abstract">Dvorak (1986)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1997CeMDA..67...41F/abstract">Froeschle et al. (1997)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2003ApJ...599.1383H/abstract">Hatzes et al. (2003)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999AJ....117..621H/abstract">Holman &amp; Wiegert (1999)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2022AJ....164..177H/abstract">Huang &amp; Ji (2022)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1992AJ....104.1230L/abstract">Lecar et al. (1992)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2017MNRAS.465.3235M/abstract">Martin (2017)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2015MNRAS.449..781M/abstract">Martin &amp; Triaud (2015)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2006A%26A...446..201M/abstract">Monin et al. (2006)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2016ARA%26A..54..441N/abstract">Naoz (2016)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJ...856..150Q/abstract">Quarles et al. (2018)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2020AJ....159...80Q/abstract">Quarles et al. (2020)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1988A%26A...191..385R/abstract">Rabl &amp; Dvorak (1988)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011A%26A...527A.140R/abstract">Reffert &amp; Quirrenbach (2011)</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1993CeMDA..56..409S/abstract">Smith &amp; Szebehely (1993)</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "saturnaxis/exoplanet-binary",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="nbody-integration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>N-body Simulations</p>
      </div>
    </a>
    <a class="right-next"
       href="planet-packing-stability.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Planet Packing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#historical-overview">3.1. Historical overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-the-standard-stability-formulae">3.2. Updating the standard stability formulae</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-for-planets-in-binary-systems">3.3. Stability for planets in binary systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sample-simulation-kepler-16b">3.3.1. A sample simulation (Kepler-16b)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sample-simulation-gamma-cephei-ab">3.3.2. A sample simulation (<span class="math notranslate nohighlight">\(\gamma\)</span> Cephei Ab)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">3.4. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Billy Quarles
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>